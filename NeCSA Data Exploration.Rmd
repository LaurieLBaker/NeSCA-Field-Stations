---
title: "NeCSA Data Exploration"
author: "Laurie Baker and Matt Clayton"
date: "1/31/2022"
output: 
  html_document:
    toc: True
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r libraries, echo = FALSE}

library(tidyverse)
library(readr)
library(leaflet)
library(dplyr)

```


## Data Overview

```{r data import, echo = FALSE}

temperature_df <- read_csv("data/NeCSA_data_template_Temperature_Data.csv")
transect_df <- read_csv("data/NeCSA_data_template_Horizontal_Transect_Data.csv")
column_meta_data <- read_csv("data/NeCSA_data_template_Column_Metadata.csv")

```


### Temperature Data
```{r explore temperature data}

glimpse(temperature_df)

```

### Transect Data

```{r explore transect data}

glimpse(transect_df)

```

### Column Meta Data

```{r explore meta data}

glimpse(column_meta_data)

```

## Plots

### Plotting Water Temperature Ranges at Each NeCSA Field Station

```{r temp-range-by-facility, echo = FALSE}

temperature_df %>%
  ggplot(mapping = aes(x = `Field Station`, 
                       y = `Water Temperature`,
                       fill = `Field Station`)) +
  geom_violin() +
  labs(title = "Ranges of Recorded Water Temperatures",
       subtitle = "By NeCSA Field Station") +
  theme(legend.position = "bottom",
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.x = element_blank(),
        legend.title = element_blank()) 
  
```

### Mapping the Location of Each NeCSA Field Station on Gulf of Maine Leaflet

```{r field-stations-leaflet, echo = FALSE}

# Create df for field station locations

field_stations <- temperature_df %>%
  group_by(`Field Station`) %>%
  select(`Field Station`, Longitude, Latitude) %>%
  distinct()

# Create labels for leaflet

labels <- sprintf(
  "<strong>%s</strong><br/>",
    field_stations$`Field Station` %>%
      lapply(htmltools::HTML)) 

# Generate Gulf of Maine leaflet indicating location of each field station

leaflet(field_stations) %>%
  addTiles() %>%
  addProviderTiles(providers$Esri.OceanBasemap) %>%
  addMarkers(~Longitude, ~Latitude, popup = labels) %>%
    setView(lng = -69, lat = 43.7, zoom = 7.5) 

```
